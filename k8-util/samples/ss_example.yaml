apiVersion: fluvio.infinyon.com/v1
kind: SmartStream
metadata:
  name: route-agg-stream1 
spec:
  inputs:
    topicSelector:
      name: route
  phase:
    processing: 
      moduleSelector:
        name: route-agg-module
---
apiVersion: fluvio.infinyon.com/v1
kind: SmartStream
metadata:
  name: route-agg-stream2
spec:
  inputs:
    topicSelector:  
      name:route
  phase:
    processing:
        template:
          metadata: 
            name: route-module
          spec:
            input_kind: Stream
            output_kind: Stream
            wasm:
              format: BINARY
              payload: AAAAAA
            parameters:
              - name: route
---
apiVersion: fluvio.infinyon.com/v1
kind: SmartStream
spec:
  inputs:
    topicSelector: 
      name: BusEvents
    streams:
    - smartStreamSelector:
        name: route_agg
        id: route
  phase:
    processing: 
      moduleSelector: 
        name: bus-joint-module
  output: 
    tableSelector: 
      name: bus-joint-table